<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Music App Mobile UI/UX Design</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@vetixy/circular-std@1.0.0/dist/index.min.css">
  <style>
    :root {
      --bg: #000;
      --surface: #1a1a1a;
      --surface-hover: #2a2a2a;
      --text: #fff;
      --text-muted: #a7a7a7;
      --primary: #1ed760;
      --primary-text: #000;
      --font: 'CircularStd', sans-serif;
      --xl: 28px;
      --lg: 20px;
      --md: 16px;
      --sm: 14px;
      --xs: 12px;
      --normal: 400;
      --medium: 500;
      --semibold: 600;
      --bold: 700;
      --s1: 4px;
      --s2: 8px;
      --s3: 12px;
      --s4: 16px;
      --s5: 20px;
      --s6: 24px;
      --s8: 32px;
      --s10: 40px;
      --r-sm: 4px;
      --r-md: 12px;
      --r-full: 9999px;
      --i-md: 24px;
      --i-lg: 28px;
      --i-xl: 32px;
      --b-md: 48px;
      --b-lg: 56px;
      --img-sm: 48px;
      --img-md: 140px;
      --img-lg: 200px;
      --pad: 16px;
      --nav: 80px;
      --z-nav: 1000;
      --z-header: 1010;
      --z-player: 2000;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      -webkit-tap-highlight-color: transparent;
    }

    button:focus,
    button:focus-visible {
      outline: none;
      box-shadow: none;
    }

    button {
      -webkit-appearance: none;
      appearance: none;
      background: transparent;
      border: none;
    }

    body {
      background: var(--bg);
      font-family: var(--font);
      color: var(--text);
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      overflow-x: hidden;
    }

    .container {
      min-height: 100vh;
      padding-bottom: var(--nav);
    }

    .home-top-bar {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      z-index: 95;
      background: var(--bg);
      transition: transform 0.3s ease;
    }

    .home-top-bar.hidden {
      transform: translateY(-100%);
    }

    .header-spacer {
      height: 164px;
    }

    .header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      padding: var(--s4);
    }

    .header-content {
      display: flex;
      flex-direction: column;
      gap: var(--s1);
    }

    .header-title {
      font-size: var(--xl);
      font-weight: var(--bold);
      line-height: 1.2;
    }

    .header-subtitle {
      font-size: var(--xs);
      font-weight: var(--normal);
      color: var(--text-muted);
      line-height: 1.5;
      max-width: 260px;
    }

    .header-actions {
      display: flex;
      gap: var(--s2);
      align-items: center;
    }

    .icon-button {
      background: transparent;
      border: none;
      color: var(--text);
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      border-radius: var(--r-full);
      width: var(--b-md);
      height: var(--b-md);
      min-width: var(--b-md);
      min-height: var(--b-md);
      padding: 0;
      user-select: none;
      outline: none;
    }

    @media (hover: hover) and (pointer: fine) {
      .icon-button {
        transition: background-color 0.2s;
      }

      .icon-button:hover {
        background: var(--surface);
      }
    }

    .icon-button:active {
      background: var(--surface);
    }

    .icon-button .material-icons {
      font-size: var(--i-md);
    }

    .tabs-wrapper {
      overflow: hidden;
      padding: 0 0 var(--s4) 0;
    }

    .tabs-container {
      display: flex;
      gap: var(--s2);
      overflow-x: auto;
      scrollbar-width: none;
      -ms-overflow-style: none;
      padding: 0 var(--pad);
      scroll-behavior: smooth;
    }

    .tabs-container::-webkit-scrollbar {
      display: none;
    }

    .tab {
      background: var(--surface);
      border: none;
      color: var(--text);
      padding: var(--s3) var(--s4);
      border-radius: var(--r-full);
      font-family: var(--font);
      font-size: var(--sm);
      font-weight: var(--medium);
      cursor: pointer;
      white-space: nowrap;
      flex-shrink: 0;
      line-height: 1.5;
      height: var(--b-md);
      display: inline-flex;
      align-items: center;
      user-select: none;
      outline: none;
    }

    @media (hover: hover) and (pointer: fine) {
      .tab {
        transition: background-color 0.2s;
      }

      .tab:hover {
        background: var(--surface-hover);
      }
    }

    .tab:active {
      background: var(--surface-hover);
    }

    .tab.active {
      background: var(--primary);
      color: var(--primary-text);
      font-weight: var(--semibold);
    }

    .shimmer {
      background: linear-gradient(90deg, var(--surface) 0%, var(--surface) 40%, var(--surface-hover) 50%, var(--surface) 60%, var(--surface) 100%);
      background-size: 200% 100%;
      animation: shimmer 2s ease-in-out infinite;
      flex-shrink: 0;
    }

    @keyframes shimmer {
      0% {
        background-position: -200% 0;
      }
      100% {
        background-position: 200% 0;
      }
    }

    .shimmer-tab {
      height: var(--b-md);
      border-radius: var(--r-full);
    }

    .shimmer-title {
      height: var(--lg);
      width: 50%;
      max-width: 160px;
      border-radius: var(--r-sm);
    }

    .shimmer-image {
      height: var(--img-md);
      width: var(--img-md);
      border-radius: var(--r-md);
      margin-bottom: var(--s4);
    }

    .shimmer-text {
      height: var(--md);
      border-radius: var(--r-sm);
      margin-bottom: var(--s1);
    }

    .shimmer-text-sm {
      height: var(--sm);
      border-radius: var(--r-sm);
    }

    .detail-background-shimmer {
      position: absolute;
      inset: 0;
      z-index: 1;
    }

    .section {
      margin-bottom: var(--s6);
    }

    .section:last-child {
      margin-bottom: 0;
    }

    .section-header {
      padding: 0 var(--pad);
      margin-bottom: var(--s4);
    }

    .section-title {
      font-size: var(--lg);
      font-weight: var(--bold);
      line-height: 1.3;
    }

    .section-items {
      display: flex;
      gap: var(--s4);
      overflow-x: auto;
      scrollbar-width: none;
      -ms-overflow-style: none;
      scroll-behavior: smooth;
      padding: 0 var(--pad);
    }

    .section-items::-webkit-scrollbar {
      display: none;
    }

    .item-container {
      flex-shrink: 0;
      cursor: pointer;
      display: flex;
      flex-direction: column;
      width: min-content;
    }

    .item-image {
      display: block;
      height: var(--img-md);
      width: var(--img-md);
      border-radius: var(--r-md);
      object-fit: cover;
      margin-bottom: var(--s4);
    }

    .item-info {
      width: 0;
      min-width: 100%;
      word-wrap: break-word;
    }

    .item-title {
      font-size: var(--md);
      font-weight: var(--medium);
      line-height: 1.5;
      overflow: hidden;
      text-overflow: ellipsis;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      line-clamp: 2;
      -webkit-box-orient: vertical;
      margin-bottom: var(--s1);
    }

    .item-artist {
      font-size: var(--sm);
      font-weight: var(--normal);
      color: var(--text-muted);
      line-height: 1.5;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    .bottom-nav {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      backdrop-filter: blur(15px);
      -webkit-backdrop-filter: blur(15px);
      background: rgba(0, 0, 0, 0.72);
      display: flex;
      justify-content: space-around;
      align-items: center;
      padding: var(--s2) var(--s4);
      z-index: var(--z-nav);
      height: var(--nav);
    }

    .nav-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: var(--s1);
      cursor: pointer;
      background: none;
      border: none;
      color: var(--text-muted);
      padding: var(--s2) var(--s3);
      user-select: none;
      outline: none;
      flex: 1;
      max-width: 100px;
    }

    @media (hover: hover) and (pointer: fine) {
      .nav-item {
        transition: color 0.2s;
      }

      .nav-item:hover {
        color: var(--text);
      }
    }

    .nav-item.active {
      color: var(--text);
    }

    .nav-item:active {
      color: var(--text);
      transform: scale(0.9);
    }

    .nav-item .material-icons {
      font-size: var(--i-md);
    }

    .nav-item-label {
      font-size: var(--xs);
      font-weight: var(--medium);
      line-height: 1;
      text-align: center;
      white-space: nowrap;
    }

    .detail-view {
      min-height: 100vh;
      background: var(--bg);
      display: none;
      padding-bottom: var(--nav);
    }

    .detail-header {
      position: relative;
      overflow: hidden;
      padding-top: var(--nav);
    }

    .detail-nav-buttons {
      position: fixed;
      inset: 0 0 auto 0;
      z-index: var(--z-header);
      display: flex;
      justify-content: space-between;
      padding: var(--s4);
      height: var(--nav);
      align-items: center;
      backdrop-filter: blur(0px);
      -webkit-backdrop-filter: blur(0px);
      background: rgba(0, 0, 0, 0);
      transition: backdrop-filter 0.2s ease, -webkit-backdrop-filter 0.2s ease, background-color 0.2s ease;
    }

    .detail-header-title {
      font-size: var(--md);
      font-weight: var(--bold);
      color: var(--text);
      flex: 1;
      margin-left: var(--s3);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      opacity: 0;
      transition: opacity 0.2s ease;
      text-align: left;
    }

    .detail-background {
      position: absolute;
      inset: 0;
      background-size: cover;
      background-position: center;
      filter: blur(15px);
      transform: scale(1.1);
      z-index: 0;
    }

    .detail-gradient {
      position: absolute;
      inset: 0;
      background: linear-gradient(180deg, rgba(0, 0, 0, 0.38) 0%, rgba(0, 0, 0, 0.5) 22%, rgba(0, 0, 0, 0.72) 46%, rgba(0, 0, 0, 0.92) 70%, #000 100%);
      z-index: 1;
    }

    .detail-cover-container {
      position: relative;
      z-index: 2;
      display: flex;
      justify-content: center;
    }

    .detail-cover {
      width: var(--img-lg);
      height: var(--img-lg);
      border-radius: var(--r-md);
      object-fit: cover;
    }

    .detail-info {
      background: var(--bg);
      padding: var(--s4) var(--pad) 0;
    }

    .detail-title {
      font-size: var(--xl);
      font-weight: var(--bold);
      line-height: 1.2;
    }

    .detail-meta {
      font-size: var(--sm);
      font-weight: var(--normal);
      color: var(--text-muted);
      line-height: 1.5;
      margin-top: var(--s2);
    }

    .detail-actions {
      background: var(--bg);
      display: flex;
      align-items: center;
      gap: var(--s2);
      padding: var(--s4) var(--pad) var(--s6);
    }

    .action-button {
      background: transparent;
      border: none;
      color: var(--text);
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      border-radius: var(--r-full);
      width: var(--b-md);
      height: var(--b-md);
      min-width: var(--b-md);
      min-height: var(--b-md);
      padding: 0;
      flex-shrink: 0;
      user-select: none;
      outline: none;
    }

    @media (hover: hover) and (pointer: fine) {
      .action-button {
        transition: background-color 0.2s;
      }

      .action-button:not(.action-button-play):hover {
        background: var(--surface);
      }
    }

    .action-button:active {
      background: var(--surface);
    }

    .action-button .material-icons {
      font-size: var(--i-lg);
    }

    .action-button-shuffle {
      margin-left: auto;
    }

    .action-button-play {
      background: var(--primary);
      color: var(--primary-text);
      width: var(--b-lg);
      height: var(--b-lg);
      min-width: var(--b-lg);
      min-height: var(--b-lg);
      margin-left: var(--s4);
    }

    .action-button-play:hover {
      background: var(--primary);
      color: var(--primary-text);
    }

    .action-button-play .material-icons {
      font-size: var(--i-xl);
    }

    .track-list {
      background: var(--bg);
      padding: 0 var(--pad);
    }

    .track-item {
      display: flex;
      align-items: center;
      gap: var(--s3);
      padding: var(--s2) 0;
      cursor: pointer;
      user-select: none;
      outline: none;
    }

    @media (hover: hover) and (pointer: fine) {
      .track-item:hover {
        background: var(--surface);
        margin: 0 calc(var(--pad) * -1);
        padding: var(--s2) var(--pad);
      }
    }

    .track-item:active {
      background: var(--surface);
      margin: 0 calc(var(--pad) * -1);
      padding: var(--s2) var(--pad);
    }

    .track-thumbnail {
      width: var(--img-sm);
      height: auto;
      border-radius: var(--r-sm);
      object-fit: cover;
      flex-shrink: 0;
    }

    .track-info {
      flex: 1;
      min-width: 0;
    }

    .track-name {
      font-size: var(--md);
      font-weight: var(--medium);
      line-height: 1.5;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    .track-artist {
      font-size: var(--sm);
      font-weight: var(--normal);
      color: var(--text-muted);
      line-height: 1.5;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
      margin-top: var(--s1);
    }

    .player-view {
      position: fixed;
      inset: 0;
      z-index: var(--z-player);
      background: var(--bg);
      display: none;
      flex-direction: column;
      transition: background-color 0.5s ease;
      padding: 0;
      overflow: hidden;
    }

    .player-content {
      flex: 1;
      display: flex;
      flex-direction: column;
      height: 100vh;
      justify-content: space-between;
    }

    .player-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: var(--s4) var(--pad);
      z-index: 10;
      flex-shrink: 0;
    }

    .player-album-art-container {
      width: 100%;
      padding: 0 var(--pad);
      flex-shrink: 0;
    }

    .player-album-art {
      width: 100%;
      height: 100%;
      border-radius: var(--r-md);
      object-fit: cover;
    }

    .player-song-info {
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      gap: var(--s2);
      z-index: 2;
      width: 100%;
      padding: 0 var(--pad);
      flex-shrink: 0;
    }

    .player-song-title-row {
      display: flex;
      align-items: center;
      justify-content: flex-start;
      gap: var(--s2);
      width: 100%;
    }

    .player-song-title {
      font-size: var(--s6);
      font-weight: var(--bold);
      color: var(--text);
      line-height: 1.25;
      text-align: left;
      min-width: 0;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
      letter-spacing: -0.015em;
      margin-bottom: var(--s1);
    }

    .player-song-artist-row {
      display: flex;
      align-items: center;
      justify-content: flex-start;
      width: 100%;
    }

    .player-song-artist {
      font-size: var(--md);
      font-weight: var(--medium);
      color: var(--text);
      opacity: 0.65;
      line-height: 1.4;
      text-align: left;
      min-width: 0;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    .player-progress {
      width: 100%;
      padding: 0 var(--pad);
      z-index: 2;
      flex-shrink: 0;
    }

    .player-progress-bar-container {
      position: relative;
      width: 100%;
      height: var(--s1);
      background: rgba(255, 255, 255, 0.15);
      border-radius: var(--r-full);
      margin-bottom: var(--s2);
      cursor: pointer;
    }

    .player-progress-bar {
      height: 100%;
      background: var(--text);
      border-radius: var(--r-full);
      width: 0%;
      position: relative;
      transition: width 0.1s linear;
    }

    .player-progress-bar::after {
      content: '';
      position: absolute;
      right: -6px;
      top: 50%;
      transform: translateY(-50%);
      width: var(--s3);
      height: var(--s3);
      background: var(--text);
      border-radius: var(--r-full);
      opacity: 1;
    }

    .player-time {
      display: flex;
      justify-content: space-between;
      font-size: var(--xs);
      font-weight: var(--medium);
      color: var(--text);
      opacity: 0.6;
      margin-top: var(--s2);
    }

    .player-controls {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 var(--pad) var(--s4);
      z-index: 2;
      width: 100%;
      max-width: 380px;
      margin: 0 auto;
      flex-shrink: 0;
    }

    .player-control-btn {
      background: transparent;
      border: none;
      color: var(--text);
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 0;
      user-select: none;
      outline: none;
      width: var(--b-md);
      height: var(--b-md);
      border-radius: var(--r-full);
      transition: opacity 0.2s, transform 0.1s;
    }

    .player-control-btn .material-icons {
      font-size: var(--i-xl);
    }

    .player-control-btn:active {
      opacity: 0.7;
      transform: scale(0.92);
    }

    .player-control-btn-shuffle .material-icons,
    .player-control-btn-repeat .material-icons {
      font-size: var(--i-lg);
      opacity: 0.7;
    }

    .player-control-btn-play {
      width: 72px;
      height: 72px;
      min-width: 72px;
      min-height: 72px;
      background: var(--text);
      border-radius: var(--r-full);
      color: var(--bg);
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .player-control-btn-play .material-icons {
      font-size: 36px;
    }

    .player-control-btn-play:active {
      transform: scale(0.94);
      opacity: 1;
    }

    .player-tabs {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0 var(--pad) var(--s6);
      z-index: 2;
      flex-shrink: 0;
    }

    .player-tab-text {
      font-size: var(--xs);
      font-weight: var(--bold);
      color: var(--text);
      opacity: 0.6;
      cursor: pointer;
      user-select: none;
      text-align: center;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .search-view {
      min-height: 100vh;
      background: var(--bg);
      display: none;
      padding-bottom: var(--nav);
    }

    .search-header {
      position: sticky;
      top: 0;
      z-index: 100;
      background: var(--bg);
      padding: var(--s4) var(--pad);
      display: flex;
      flex-direction: column;
      gap: var(--s4);
    }

    .search-title {
      font-size: var(--xl);
      font-weight: var(--bold);
      margin-bottom: var(--s2);
    }

    .search-input-container {
      position: relative;
      width: 100%;
      height: var(--b-md);
      background: var(--surface);
      border-radius: var(--r-md);
      display: flex;
      align-items: center;
      padding: 0 var(--s3);
      transition: background-color 0.2s;
    }

    .search-input-container:focus-within {
      background: var(--surface-hover);
    }

    .search-icon {
      color: var(--text-muted);
      margin-right: var(--s2);
    }

    .search-input {
      flex: 1;
      background: transparent;
      border: none;
      color: var(--text);
      font-family: var(--font);
      font-size: var(--md);
      font-weight: var(--medium);
      outline: none;
      height: 100%;
    }

    .search-input::placeholder {
      color: var(--text-muted);
    }

    .search-results {
      padding: var(--s4) var(--pad);
    }
  </style>
</head>

<body>
  <div class="container" id="homeView">
    <div id="homeTopBar" class="home-top-bar">
      <header class="header">
        <div class="header-content">
          <h1 class="header-title">Buenos días</h1>
          <p class="header-subtitle">Recarga tu energía al ritmo de la música que amas.</p>
        </div>
        <div class="header-actions">
          <button class="icon-button" aria-label="Notificaciones" type="button">
            <span class="material-icons">notifications_none</span>
          </button>
          <button class="icon-button" aria-label="Configuración" type="button">
            <span class="material-icons">settings</span>
          </button>
        </div>
      </header>
      <div class="tabs-wrapper">
        <div class="tabs-container" id="tabs"></div>
      </div>
    </div>
    <div class="header-spacer"></div>
    <main id="content"></main>
  </div>

  <div class="container" id="exploreView" style="display: none;">
    <header class="header">
      <div class="header-content">
        <h1 class="header-title">Explorar</h1>
        <p class="header-subtitle">Descubre nueva música, listas de éxitos y tendencias.</p>
      </div>
      <div class="header-actions">
        <button class="icon-button" aria-label="Notificaciones" type="button">
          <span class="material-icons">notifications_none</span>
        </button>
        <button class="icon-button" aria-label="Configuración" type="button">
          <span class="material-icons">settings</span>
        </button>
      </div>
    </header>
    <main id="exploreContent"></main>
  </div>

  <div class="detail-view" id="detailView">
    <div class="detail-header">
      <div class="detail-background" id="detailBackground"></div>
      <div class="detail-gradient"></div>
      <div class="detail-nav-buttons">
        <button class="icon-button" aria-label="Volver" id="backButton" type="button">
          <span class="material-icons">arrow_back</span>
        </button>
        <span class="detail-header-title" id="detailHeaderTitle"></span>
        <button class="icon-button" aria-label="Buscar" type="button">
          <span class="material-icons">search</span>
        </button>
      </div>
      <div class="detail-cover-container">
        <img class="detail-cover" id="detailCover" src="" alt="">
      </div>
    </div>
    <div class="detail-info">
      <h1 class="detail-title" id="detailTitle"></h1>
      <div class="detail-meta" id="detailMeta"></div>
    </div>
    <div class="detail-actions">
      <button class="action-button" aria-label="Agregar" type="button">
        <span class="material-icons">add_circle_outline</span>
      </button>
      <button class="action-button" aria-label="Descargar" type="button">
        <span class="material-icons">arrow_circle_down</span>
      </button>
      <button class="action-button" aria-label="Más opciones" type="button">
        <span class="material-icons">more_horiz</span>
      </button>
      <button class="action-button action-button-shuffle" aria-label="Aleatorio" type="button">
        <span class="material-icons">shuffle</span>
      </button>
      <button class="action-button action-button-play" aria-label="Reproducir" id="detailPlayButton" type="button">
        <span class="material-icons">play_arrow</span>
      </button>
    </div>
    <div class="track-list" id="trackList"></div>
  </div>

  <div class="player-view" id="playerView">
    <div class="player-content">
      <div class="player-header" id="playerHeader">
        <button class="icon-button" aria-label="Cerrar" id="playerCloseButton" type="button">
          <span class="material-icons">keyboard_arrow_down</span>
        </button>
        <button class="icon-button" aria-label="Más opciones" type="button">
          <span class="material-icons">more_vert</span>
        </button>
      </div>
      <div class="player-album-art-container">
        <img class="player-album-art" id="playerAlbumArt" src="" alt="Album Art">
      </div>
      <div class="player-song-info">
        <div class="player-song-title-row">
          <div class="player-song-title" id="playerSongTitle">Mírame Ma</div>
        </div>
        <div class="player-song-artist-row">
          <div class="player-song-artist" id="playerSongArtist">Alemán, Rels B</div>
        </div>
      </div>
      <div class="player-progress">
        <div class="player-progress-bar-container" id="progressBarContainer">
          <div class="player-progress-bar" id="progressBar"></div>
        </div>
        <div class="player-time">
          <span id="currentTime">0:00</span>
          <span id="remainingTime">-3:45</span>
        </div>
      </div>
      <div class="player-controls">
        <button class="player-control-btn player-control-btn-shuffle" aria-label="Aleatorio" type="button">
          <span class="material-icons">shuffle</span>
        </button>
        <button class="player-control-btn" aria-label="Anterior" type="button">
          <span class="material-icons">skip_previous</span>
        </button>
        <button class="player-control-btn player-control-btn-play" aria-label="Reproducir/Pausar" id="playPauseBtn" type="button">
          <span class="material-icons" id="playPauseIcon">pause</span>
        </button>
        <button class="player-control-btn" aria-label="Siguiente" type="button">
          <span class="material-icons">skip_next</span>
        </button>
        <button class="player-control-btn player-control-btn-repeat" aria-label="Repetir" type="button">
          <span class="material-icons">repeat</span>
        </button>
      </div>
      <div class="player-tabs">
        <div class="player-tab-text">A continuación</div>
        <div class="player-tab-text">Letra</div>
        <div class="player-tab-text">Similares</div>
      </div>
    </div>
  </div>

  <div class="search-view" id="searchView">
    <div class="search-header">
      <h1 class="search-title">Buscar</h1>
      <div class="search-input-container">
        <span class="material-icons search-icon">search</span>
        <input type="text" class="search-input" id="searchInput" placeholder="¿Qué quieres escuchar?">
      </div>
    </div>
    <div class="search-results" id="searchResults"></div>
  </div>

  <nav class="bottom-nav">
    <button class="nav-item active" aria-label="Inicio" type="button">
      <span class="material-icons">home</span>
      <span class="nav-item-label">Inicio</span>
    </button>
    <button class="nav-item" aria-label="Buscar" type="button">
      <span class="material-icons">search</span>
      <span class="nav-item-label">Buscar</span>
    </button>
    <button class="nav-item" aria-label="Explorar" type="button">
      <span class="material-icons">explore</span>
      <span class="nav-item-label">Explorar</span>
    </button>
    <button class="nav-item" aria-label="Tu biblioteca" type="button">
      <span class="material-icons">library_music</span>
      <span class="nav-item-label">Biblioteca</span>
    </button>
  </nav>

  <script>
    const API = 'https://braided-music-1--noreplyscuritym.replit.app/api';
    let currentFilter = null;
    let currentDominantColor = 'rgb(0, 0, 0)';

    const addUnifiedClickHandler = (element, handler) => {
      let startX = 0;
      let startY = 0;
      let isScrolling = false;

      element.addEventListener('touchstart', (e) => {
        startX = e.changedTouches[0].pageX;
        startY = e.changedTouches[0].pageY;
        isScrolling = false;
      }, { passive: true });

      element.addEventListener('touchend', (e) => {
        const endX = e.changedTouches[0].pageX;
        const endY = e.changedTouches[0].pageY;
        const diffX = Math.abs(endX - startX);
        const diffY = Math.abs(endY - startY);

        if (diffX > 10 || diffY > 10) {
          isScrolling = true;
          return;
        }

        e.preventDefault();
        handler(e);
      });

      element.addEventListener('click', (e) => {
        if (isScrolling) {
          isScrolling = false;
          return;
        }
        handler(e);
      });
    };

    const getDominantColor = (imageUrl) => {
      return new Promise((resolve) => {
        const img = new Image();
        img.crossOrigin = 'anonymous';
        const timeout = setTimeout(() => resolve('rgb(0, 0, 0)'), 5000);

        img.onload = () => {
          clearTimeout(timeout);
          try {
            const canvas = document.createElement('canvas');
            const ctx = canvas.getContext('2d');
            const maxSize = 200;
            const scale = Math.min(maxSize / img.width, maxSize / img.height, 1);
            canvas.width = img.width * scale;
            canvas.height = img.height * scale;
            ctx.drawImage(img, 0, 0, canvas.width, canvas.height);

            const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
            const data = imageData.data;
            const colorCount = {};
            const sampleSize = 4;

            for (let i = 0; i < data.length; i += sampleSize * 4) {
              const r = data[i];
              const g = data[i + 1];
              const b = data[i + 2];
              const brightness = (r + g + b) / 3;

              if (brightness < 20 || brightness > 235) continue;

              const colorKey = `${Math.floor(r / 10) * 10},${Math.floor(g / 10) * 10},${Math.floor(b / 10) * 10}`;
              colorCount[colorKey] = (colorCount[colorKey] || 0) + 1;
            }

            let maxCount = 0;
            let dominantColor = 'rgb(0, 0, 0)';

            for (const [color, count] of Object.entries(colorCount)) {
              if (count > maxCount) {
                maxCount = count;
                const [r, g, b] = color.split(',');
                dominantColor = `rgb(${r}, ${g}, ${b})`;
              }
            }

            resolve(dominantColor);
          } catch (err) {
            resolve('rgb(0, 0, 0)');
          }
        };

        img.onerror = () => {
          clearTimeout(timeout);
          resolve('rgb(0, 0, 0)');
        };

        img.src = imageUrl;
      });
    };

    const applyDominantColor = async (imageUrl) => {
      const color = await getDominantColor(imageUrl);
      currentDominantColor = color;
      const playerView = document.getElementById('playerView');
      const playerHeader = document.getElementById('playerHeader');

      if (playerView) {
        const darkenedColor = darkenColor(color, 0.65);
        playerView.style.backgroundColor = darkenedColor;
      }

      if (playerHeader) {
        const headerColor = darkenColor(color, 0.65);
        playerHeader.style.backgroundColor = headerColor;
      }
    };

    const darkenColor = (rgbString, factor) => {
      const match = rgbString.match(/rgb\((\d+),\s*(\d+),\s*(\d+)\)/);
      if (!match) return rgbString;

      const r = Math.max(0, Math.floor(parseInt(match[1]) * (1 - factor)));
      const g = Math.max(0, Math.floor(parseInt(match[2]) * (1 - factor)));
      const b = Math.max(0, Math.floor(parseInt(match[3]) * (1 - factor)));

      return `rgb(${r}, ${g}, ${b})`;
    };

    const getThumbnailUrl = (item) => {
      if (item && item.thumbnails && item.thumbnails.length > 0) {
        return item.thumbnails[0].url;
      }
      return null;
    };

    const App = {
      currentView: 'home',
      previousView: 'home',
      viewHistory: [],
      views: {},
      header: null,
      actions: null,
      headerTitle: null,
      currentTitle: '',
      exploreDataLoaded: false,

      init() {
        this.views.home = document.getElementById('homeView');
        this.views.explore = document.getElementById('exploreView');
        this.views.detail = document.getElementById('detailView');
        this.views.player = document.getElementById('playerView');
        this.views.search = document.getElementById('searchView');
        this.header = document.querySelector('.detail-nav-buttons');
        this.actions = document.querySelector('.detail-actions');
        this.headerTitle = document.getElementById('detailHeaderTitle');

        this.showView('home');
        this.setupBackButton();
        this.setupScrollListener();
        this.setupPlayer();
        this.setupNavigation();
      },

      setupNavigation() {
        const navItems = document.querySelectorAll('.nav-item');
        navItems.forEach(item => {
          addUnifiedClickHandler(item, () => {
            navItems.forEach(n => n.classList.remove('active'));
            item.classList.add('active');

            const label = item.querySelector('.nav-item-label').textContent;
            if (label === 'Inicio') {
              this.viewHistory = [];
              this.showView('home');
            } else if (label === 'Explorar') {
              this.viewHistory = [];
              this.showView('explore');
              if (!this.exploreDataLoaded) {
                this.loadExploreData();
              }
            } else if (label === 'Buscar') {
              this.viewHistory = [];
              this.showView('search');
            }
          });
        });
      },

      async loadExploreData() {
        const container = document.getElementById('exploreContent');
        createExploreShimmer();

        try {
          const res = await fetch(`${API}/explore`);
          if (!res.ok) throw new Error('Explore failed');

          const data = await res.json();
          this.exploreDataLoaded = true;
          this.renderExploreContent(data.sections);
        } catch (err) {
          container.innerHTML = '';
        }
      },

      renderExploreContent(sections) {
        const container = document.getElementById('exploreContent');
        container.innerHTML = '';
        if (!sections?.length) return;

        sections.forEach(section => {
          if (!section.title && !section.items?.length) return;

          const el = document.createElement('section');
          el.className = 'section';

          if (section.title) {
            const h = document.createElement('div');
            h.className = 'section-header';
            const t = document.createElement('h2');
            t.className = 'section-title';
            t.textContent = section.title;
            h.appendChild(t);
            el.appendChild(h);
          }

          if (section.items?.length) {
            const its = document.createElement('div');
            its.className = 'section-items';

            section.items.forEach(item => {
              const thumbnailUrl = getThumbnailUrl(item);
              if (!thumbnailUrl) return;

              const ic = document.createElement('div');
              ic.className = 'item-container';

              addUnifiedClickHandler(ic, () => {
                if (item.type === 'song' || item.type === 'video') {
                  App.openPlayer(item, section.title);
                } else if (item.type === 'playlist' || item.type === 'album') {
                  const id = item.playlistId || item.browseId;
                  if (id) {
                    openPlaylist(id);
                  } else if (item.videoId) {
                    App.openPlayer(item, section.title);
                  }
                }
              });

              const img = document.createElement('img');
              img.className = 'item-image';
              img.src = thumbnailUrl;
              img.alt = item.title || 'Imagen';
              img.loading = 'lazy';
              ic.appendChild(img);

              const inf = document.createElement('div');
              inf.className = 'item-info';

              if (item.title) {
                const tit = document.createElement('div');
                tit.className = 'item-title';
                tit.textContent = item.title;
                inf.appendChild(tit);
              }

              if (item.artist) {
                const art = document.createElement('div');
                art.className = 'item-artist';
                art.textContent = item.artist;
                inf.appendChild(art);
              }

              ic.appendChild(inf);
              its.appendChild(ic);
            });

            el.appendChild(its);
          }

          container.appendChild(el);
        });
      },

      setupBackButton() {
        const backBtn = document.getElementById('backButton');
        addUnifiedClickHandler(backBtn, () => {
          if (this.viewHistory.length > 0) {
            const previousView = this.viewHistory.pop();
            this.showView(previousView, true);
          } else {
            this.showView('home', true);
          }
        });
      },

      setupScrollListener() {
        let lastScrollY = window.scrollY;
        const homeTopBar = document.getElementById('homeTopBar');

        window.addEventListener('scroll', () => {
          const currentScrollY = window.scrollY;

          if (this.currentView === 'home') {
            if (currentScrollY > lastScrollY && currentScrollY > 20) {
              homeTopBar?.classList.add('hidden');
            } else {
              homeTopBar?.classList.remove('hidden');
            }
          }

          if (this.currentView === 'detail') {
            this.updateHeaderOpacity();
          }

          lastScrollY = currentScrollY;
        });

        const playerView = document.getElementById('playerView');
        if (playerView) {
          let playerStartY = 0;

          playerView.addEventListener('touchstart', (e) => {
            playerStartY = e.touches[0].clientY;
          }, { passive: true });

          playerView.addEventListener('touchmove', (e) => {
            const playerCurrentY = e.touches[0].clientY;
            const deltaY = playerCurrentY - playerStartY;
            
            if (deltaY > 100) {
              if (this.viewHistory.length > 0) {
                const previousView = this.viewHistory.pop();
                this.showView(previousView, true);
              } else {
                this.showView('home', true);
              }
            }
          }, { passive: true });
        }
      },

      setupPlayer() {
        const closeBtn = document.getElementById('playerCloseButton');
        if (closeBtn) {
          addUnifiedClickHandler(closeBtn, () => {
            if (this.viewHistory.length > 0) {
              const previousView = this.viewHistory.pop();
              this.showView(previousView, true);
            } else {
              this.showView('home', true);
            }
          });
        }

        const playPauseBtn = document.getElementById('playPauseBtn');
        if (playPauseBtn) {
          addUnifiedClickHandler(playPauseBtn, () => {
            const icon = document.getElementById('playPauseIcon');
            if (icon) {
              const isPlaying = icon.textContent === 'play_arrow';
              icon.textContent = isPlaying ? 'pause' : 'play_arrow';
            }
          });
        }
      },

      updateHeaderOpacity() {
        if (!this.header || !this.actions) {
          this.header = document.querySelector('.detail-nav-buttons');
          this.actions = document.querySelector('.detail-actions');
          if (!this.header || !this.actions) return;
        }

        const scrollY = window.scrollY;
        const threshold = this.actions.offsetTop + this.actions.offsetHeight - this.header.offsetHeight;
        const opacity = Math.min(1, scrollY / Math.max(1, threshold));
        const blur = opacity * 15;

        this.header.style.backdropFilter = `blur(${blur}px)`;
        this.header.style.webkitBackdropFilter = `blur(${blur}px)`;
        this.header.style.backgroundColor = `rgba(0, 0, 0, ${opacity * 0.72})`;

        if (this.headerTitle) this.headerTitle.style.opacity = opacity;
      },

      showView(viewName, isBackNavigation = false) {
        if (!isBackNavigation && viewName !== 'player' && this.currentView !== 'player') {
          if (this.currentView !== viewName) {
            this.viewHistory.push(this.currentView);
          }
        }

        if (viewName !== 'player' && this.currentView !== 'player') {
          this.previousView = this.currentView;
        }

        Object.keys(this.views).forEach(key => {
          if (key === viewName) {
            if (key === 'player') {
              this.views[key].style.display = 'flex';
            } else {
              this.views[key].style.display = 'block';
            }
          } else {
            this.views[key].style.display = 'none';
          }
        });
        this.currentView = viewName;

        if (viewName === 'home') {
          if (this.header) {
            this.header.style.backdropFilter = 'blur(0px)';
            this.header.style.webkitBackdropFilter = 'blur(0px)';
            this.header.style.backgroundColor = 'rgba(0, 0, 0, 0)';
          }
          if (this.headerTitle) {
            this.headerTitle.style.opacity = '0';
            this.headerTitle.innerText = '';
          }
        } else if (viewName === 'detail') {
          window.scrollTo(0, 0);
          this.updateHeaderOpacity();
        }
      },

      openPlayer(track, sectionTitle) {
        const playerView = document.getElementById('playerView');
        const playerHeader = document.getElementById('playerHeader');
        const albumArt = document.getElementById('playerAlbumArt');
        const songTitle = document.getElementById('playerSongTitle');
        const songArtist = document.getElementById('playerSongArtist');

        currentDominantColor = 'rgb(0, 0, 0)';
        playerView.style.backgroundColor = 'rgb(0, 0, 0)';
        if (playerHeader) {
          playerHeader.style.backgroundColor = 'rgb(0, 0, 0)';
        }

        if (track) {
          const thumbnailUrl = getThumbnailUrl(track);

          if (thumbnailUrl) {
            albumArt.src = thumbnailUrl;
            albumArt.alt = track.title || 'Album Art';
            applyDominantColor(thumbnailUrl);
          } else {
            playerView.style.backgroundColor = 'rgb(0, 0, 0)';
            currentDominantColor = 'rgb(0, 0, 0)';
            if (playerHeader) {
              playerHeader.style.backgroundColor = 'rgb(0, 0, 0)';
            }
          }

          if (track.title) {
            songTitle.textContent = track.title;
          }

          if (track.artist) {
            songArtist.textContent = track.artist;
          } else if (track.album) {
            songArtist.textContent = track.album;
          }
        }

        this.showView('player');
      }
    };

    const createTabsShimmer = () => {
      const c = document.getElementById('tabs');
      c.innerHTML = '';
      [80, 100, 90, 110, 85, 95].forEach(w => {
        const s = document.createElement('div');
        s.className = 'shimmer shimmer-tab';
        s.style.width = `${w}px`;
        c.appendChild(s);
      });
    };

    const createContentShimmer = () => {
      const c = document.getElementById('content');
      c.innerHTML = '';
      for (let i = 0; i < 4; i++) {
        const sec = document.createElement('div');
        sec.className = 'section';

        const h = document.createElement('div');
        h.className = 'section-header';
        const t = document.createElement('div');
        t.className = 'shimmer shimmer-title';
        h.appendChild(t);
        sec.appendChild(h);

        const its = document.createElement('div');
        its.className = 'section-items';
        for (let j = 0; j < 5; j++) {
          const ic = document.createElement('div');
          ic.className = 'item-container';

          const img = document.createElement('div');
          img.className = 'shimmer shimmer-image';
          ic.appendChild(img);

          const inf = document.createElement('div');
          inf.className = 'item-info';

          const ts = document.createElement('div');
          ts.className = 'shimmer shimmer-text';
          ts.style.width = '80%';
          inf.appendChild(ts);

          const as = document.createElement('div');
          as.className = 'shimmer shimmer-text-sm';
          as.style.width = '60%';
          inf.appendChild(as);

          ic.appendChild(inf);
          its.appendChild(ic);
        }
        sec.appendChild(its);
        c.appendChild(sec);
      }
    };

    const createExploreShimmer = () => {
      const c = document.getElementById('exploreContent');
      c.innerHTML = '';
      for (let i = 0; i < 4; i++) {
        const sec = document.createElement('div');
        sec.className = 'section';

        const h = document.createElement('div');
        h.className = 'section-header';
        const t = document.createElement('div');
        t.className = 'shimmer shimmer-title';
        h.appendChild(t);
        sec.appendChild(h);

        const its = document.createElement('div');
        its.className = 'section-items';
        for (let j = 0; j < 5; j++) {
          const ic = document.createElement('div');
          ic.className = 'item-container';
          ic.style.width = 'var(--img-md)';

          const img = document.createElement('div');
          img.className = 'shimmer shimmer-image';
          ic.appendChild(img);

          const inf = document.createElement('div');
          inf.className = 'item-info';
          inf.style.width = '100%';

          const ts = document.createElement('div');
          ts.className = 'shimmer shimmer-text';
          ts.style.width = '80%';
          inf.appendChild(ts);

          const as = document.createElement('div');
          as.className = 'shimmer shimmer-text-sm';
          as.style.width = '60%';
          inf.appendChild(as);

          ic.appendChild(inf);
          its.appendChild(ic);
        }
        sec.appendChild(its);
        c.appendChild(sec);
      }
    };

    const createDetailShimmer = () => {
      const bg = document.getElementById('detailBackground');
      const bgContainer = bg.parentElement;
      const cv = document.getElementById('detailCover');
      const tt = document.getElementById('detailTitle');
      const mt = document.getElementById('detailMeta');
      const tl = document.getElementById('trackList');

      bg.style.backgroundImage = 'none';
      bg.style.backgroundColor = 'transparent';
      const bgShimmer = document.createElement('div');
      bgShimmer.className = 'detail-background-shimmer shimmer';
      bgContainer.insertBefore(bgShimmer, bg.nextSibling);

      cv.style.display = 'none';
      const cvShimmer = document.createElement('div');
      cvShimmer.className = 'shimmer';
      cvShimmer.style.width = 'var(--img-lg)';
      cvShimmer.style.height = 'var(--img-lg)';
      cvShimmer.style.borderRadius = 'var(--r-md)';
      cvShimmer.style.flexShrink = '0';
      cv.parentElement.appendChild(cvShimmer);

      tt.innerHTML = '';
      const ttShimmer = document.createElement('div');
      ttShimmer.className = 'shimmer';
      ttShimmer.style.width = '70%';
      ttShimmer.style.height = 'var(--xl)';
      ttShimmer.style.borderRadius = 'var(--r-sm)';
      tt.appendChild(ttShimmer);

      mt.innerHTML = '';
      const mtShimmer1 = document.createElement('div');
      mtShimmer1.className = 'shimmer';
      mtShimmer1.style.width = '100%';
      mtShimmer1.style.height = 'var(--sm)';
      mtShimmer1.style.borderRadius = 'var(--r-sm)';
      mt.appendChild(mtShimmer1);
      const mtShimmer2 = document.createElement('div');
      mtShimmer2.className = 'shimmer';
      mtShimmer2.style.width = '80%';
      mtShimmer2.style.height = 'var(--sm)';
      mtShimmer2.style.borderRadius = 'var(--r-sm)';
      mtShimmer2.style.marginTop = 'var(--s1)';
      mt.appendChild(mtShimmer2);

      tl.innerHTML = '';
      for (let i = 0; i < 8; i++) {
        const ti = document.createElement('div');
        ti.style.display = 'flex';
        ti.style.alignItems = 'center';
        ti.style.gap = 'var(--s3)';
        ti.style.padding = 'var(--s2) 0';

        const th = document.createElement('div');
        th.className = 'shimmer';
        th.style.width = 'var(--img-sm)';
        th.style.height = 'var(--img-sm)';
        th.style.borderRadius = 'var(--r-sm)';
        th.style.flexShrink = '0';
        ti.appendChild(th);

        const inf = document.createElement('div');
        inf.style.flex = '1';
        inf.style.minWidth = '0';

        const n = document.createElement('div');
        n.className = 'shimmer';
        n.style.width = '80%';
        n.style.height = 'var(--md)';
        n.style.borderRadius = 'var(--r-sm)';
        n.style.marginBottom = 'var(--s1)';
        inf.appendChild(n);

        const a = document.createElement('div');
        a.className = 'shimmer';
        a.style.width = '60%';
        a.style.height = 'var(--sm)';
        a.style.borderRadius = 'var(--r-sm)';
        inf.appendChild(a);

        ti.appendChild(inf);
        tl.appendChild(ti);
      }
    };

    const openPlaylist = async (id) => {
      App.showView('detail');

      const tl = document.getElementById('trackList');
      tl.innerHTML = '';

      createDetailShimmer();

      try {
        const res = await fetch(`${API}/browse/${id}`);
        if (!res.ok) return;
        const data = await res.json();
        showDetail(data);
      } catch (err) {}
    };

    const showDetail = (data) => {
      App.currentTitle = data.title || '';
      if (App.headerTitle) App.headerTitle.innerText = App.currentTitle;

      const bg = document.getElementById('detailBackground');
      const bgContainer = bg.parentElement;
      const cv = document.getElementById('detailCover');
      const cvContainer = cv.parentElement;
      const tt = document.getElementById('detailTitle');
      const mt = document.getElementById('detailMeta');
      const tl = document.getElementById('trackList');

      const bgShimmer = bgContainer.querySelector('.detail-background-shimmer');
      const cvShimmer = cvContainer.querySelector('.shimmer');

      if (cvShimmer) {
        cvShimmer.remove();
      }
      cv.style.display = 'block';

      const thumbnailUrl = getThumbnailUrl(data);

      if (thumbnailUrl) {
        cv.src = thumbnailUrl;
        cv.alt = data.title || 'Cover';
        cv.onerror = () => {
          cv.style.display = 'none';
          const shimmer = document.createElement('div');
          shimmer.className = 'shimmer';
          shimmer.style.width = 'var(--img-lg)';
          shimmer.style.height = 'var(--img-lg)';
          shimmer.style.borderRadius = 'var(--r-md)';
          shimmer.style.flexShrink = '0';
          cvContainer.appendChild(shimmer);
        };

        const bgImg = new Image();
        bgImg.src = thumbnailUrl;
        bgImg.onload = () => {
          bg.style.backgroundImage = `url('${thumbnailUrl}')`;
          if (bgShimmer) bgShimmer.remove();
        };
        bgImg.onerror = () => {
          if (bgShimmer) bgShimmer.remove();
        };
      } else {
        if (bgShimmer) bgShimmer.remove();
      }

      tt.innerHTML = '';
      tt.textContent = data.title || '';

      mt.innerHTML = '';
      mt.textContent = data.description || '';

      const detailPlayBtn = document.getElementById('detailPlayButton');
      if (detailPlayBtn && data.tracks?.length) {
        detailPlayBtn.onclick = null;
        addUnifiedClickHandler(detailPlayBtn, () => {
          App.openPlayer(data.tracks[0]);
        });
      }

      tl.innerHTML = '';
      if (data.tracks?.length) {
        data.tracks.forEach((track, i) => {
          const ti = document.createElement('div');
          ti.className = 'track-item';

          const trackThumbnailUrl = getThumbnailUrl(track);

          if (trackThumbnailUrl) {
            const th = document.createElement('img');
            th.className = 'track-thumbnail';
            th.src = trackThumbnailUrl;
            th.alt = track.title || '';

            th.onerror = () => {
              th.style.display = 'none';
              const shimmer = document.createElement('div');
              shimmer.className = 'shimmer';
              shimmer.style.width = 'var(--img-sm)';
              shimmer.style.height = 'var(--img-sm)';
              shimmer.style.borderRadius = 'var(--r-sm)';
              shimmer.style.flexShrink = '0';
              ti.insertBefore(shimmer, ti.firstChild);
            };

            ti.appendChild(th);
          }

          const inf = document.createElement('div');
          inf.className = 'track-info';

          const n = document.createElement('div');
          n.className = 'track-name';
          n.textContent = track.title || `Track ${i + 1}`;
          inf.appendChild(n);

          if (track.artist) {
            const a = document.createElement('div');
            a.className = 'track-artist';
            a.textContent = track.artist;
            inf.appendChild(a);
          }

          ti.appendChild(inf);

          addUnifiedClickHandler(ti, () => {
            App.openPlayer(track);
          });

          tl.appendChild(ti);
        });
      }
    };

    const renderContent = (sections) => {
      const c = document.getElementById('content');
      c.innerHTML = '';
      if (!sections?.length) return;

      sections.forEach(section => {
        if (!section.title) return;

        const el = document.createElement('section');
        el.className = 'section';

        const h = document.createElement('div');
        h.className = 'section-header';
        const t = document.createElement('h2');
        t.className = 'section-title';
        t.textContent = section.title;
        h.appendChild(t);
        el.appendChild(h);

        if (section.items?.length) {
          const its = document.createElement('div');
          its.className = 'section-items';

          section.items.forEach(item => {
            const thumbnailUrl = getThumbnailUrl(item);
            if (!thumbnailUrl) return;

            const ic = document.createElement('div');
            ic.className = 'item-container';

            addUnifiedClickHandler(ic, () => {
              if (item.type === 'song' || item.type === 'video') {
                App.openPlayer(item, section.title);
              } else if (item.type === 'playlist' || item.type === 'album') {
                const id = item.playlistId || item.browseId;
                if (id) openPlaylist(id);
              }
            });

            const img = document.createElement('img');
            img.className = 'item-image';
            img.src = thumbnailUrl;
            img.alt = item.title || 'Imagen';
            img.loading = 'lazy';

            img.onerror = () => {
              img.style.display = 'none';
              const shimmer = document.createElement('div');
              shimmer.className = 'shimmer';
              shimmer.style.width = 'var(--img-md)';
              shimmer.style.height = 'var(--img-md)';
              shimmer.style.borderRadius = 'var(--r-md)';
              shimmer.style.marginBottom = 'var(--s4)';
              shimmer.style.flexShrink = '0';
              ic.insertBefore(shimmer, ic.firstChild);
            };

            ic.appendChild(img);

            const inf = document.createElement('div');
            inf.className = 'item-info';

            if (item.title) {
              const tit = document.createElement('div');
              tit.className = 'item-title';
              tit.textContent = item.title;
              inf.appendChild(tit);
            }

            if (item.artist) {
              const art = document.createElement('div');
              art.className = 'item-artist';
              art.textContent = item.artist;
              inf.appendChild(art);
            }

            ic.appendChild(inf);
            its.appendChild(ic);
          });

          el.appendChild(its);
        }

        c.appendChild(el);
      });
    };

    const renderTabs = (chips) => {
      const c = document.getElementById('tabs');
      c.innerHTML = '';

      if (chips?.length) {
        chips.forEach(ch => {
          const t = document.createElement('button');
          t.className = `tab${ch.text === currentFilter || (currentFilter === null && ch.is_selected) ? ' active' : ''}`;
          t.setAttribute('role', 'tab');
          t.textContent = ch.text;

          addUnifiedClickHandler(t, () => {
            currentFilter = ch.text;
            loadData(ch.text);
          });

          c.appendChild(t);
        });
      }
    };

    const loadData = async (f) => {
      createTabsShimmer();
      createContentShimmer();

      try {
        const url = f ? `${API}/home?filter=${encodeURIComponent(f)}` : `${API}/home`;
        const res = await fetch(url);
        if (!res.ok) return;

        const data = await res.json();
        renderTabs(data.header?.chips || []);
        if (data.sections) renderContent(data.sections);
      } catch (err) {}
    };

    App.init();
    loadData();
  </script>
</body>

</html>